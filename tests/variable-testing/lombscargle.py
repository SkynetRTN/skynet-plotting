from astropy.timeseries import LombScargle
from gatspy.periodic import LombScargleFast

def l_gatspy():
    from gatspy.periodic import LombScargleFast
    from gatspy.periodic.lomb_scargle_fast import lomb_scargle_fast

    t = [2455263.5230960627, 2455263.5481076366, 2455263.5490798587, 2455263.583848377, 2455263.584832174, 2455263.625989581, 2455263.6269849516, 2455265.520839118, 2455265.5218113405, 2455265.5837789327, 2455265.5847627292, 2455265.6254340257, 2455265.6264293958, 2455266.5401562476, 2455266.541140044, 2455266.54212384, 2455266.548802081, 2455266.5840335623, 2455266.585028933, 2455267.524554396, 2455267.525538192, 2455267.5493344883, 2455267.584103007, 2455267.5850868034, 2455267.6254340257, 2455267.6264178217, 2455268.517725692, 2455268.518697914, 2455268.542575229, 2455268.5435474515, 2455268.5839062477, 2455268.584890044, 2455268.6254455997, 2455268.6264293958, 2455269.5231192107, 2455269.524103007, 2455269.542528933, 2455269.5435243035, 2455269.584126155, 2455269.5850983774, 2455269.6254918957, 2455269.6264756923, 2455269.751776618, 2455269.7527604145, 2455269.7921701367, 2455269.793153933, 2455269.834126155, 2455269.8351099514, 2455269.8758738404, 2455269.8768576365]
    y = [13.52, 13.62, 13.67, 13.84, 13.81, 13.96, 13.98, 14.45, 14.43, 14.42, 14.4, 14.53, 14.5, 14.299999999999999, 14.33, 14.33, 14.36, 14.389999999999999, 14.36, 13.85, 13.86, 13.93, 14.07, 14.09, 14.2, 14.229999999999999, 13.37, 13.35, 13.319999999999999, 13.3, 13.54, 13.55, 13.76, 13.77, 14.42, 14.42, 14.5, 14.51, 14.52, 14.53, 13.870000000000001, 13.870000000000001, 13.79, 13.77, 13.92, 13.92, 14.08, 14.11, 14.26, 14.26]

    model = LombScargleFast().fit(t, y)
    periods, power = model.periodogram_auto()
    # periods, power = lomb_scargle_fast(t, y, dy=1, f0=0.03, df=0.03, Nf=375)

    for i in range(0, len(periods)):
        if periods[i] > 0.55 and periods[i] < 0.57:
            print(i, periods[i], power[i])

def l_astropy():
    t = [0.8095103679551281, 0.7880337075000581, 0.7878116490250928, 0.919007616676379, 0.8875729210584646, 0.7009154435752887, 0.7212745531375537, 0.7138758512353984, 0.7475014899153445, 0.774525708798393, 0.7510644837365952, 0.24080769841194538, 0.2591869598889822, 0.3378349678204886, 0.45352672101095326, 0.47071756176625357, 0.6109046626482941, 0.6123532264625178, -0.24880434527359974, -0.26285562732166845, -0.2825078969218371, -0.3008022333987759, -0.06140476560027874, -0.046370009343221774, 0.15655034039591076, 0.15855913641005426, 0.8167615616985184, 0.814800362399505, 0.8799107023287505, 0.8808707786485783, 0.9133813570131188, 0.912038479401744, 0.2613387860708718, 0.24953412925558993, 0.1697049944475948, 0.15913496708283237, 0.3159416105814712, 0.3207107200133521, 0.4734777921512716, 0.48727611115361746, 0.6411587537897026, 0.6171292478959618, -0.10577073232365741, 0.006003800889647692, 0.04691659010690952, 0.2059015715861232, 0.18202285791729356, 0.36367069528987894, 0.3707100980341256]
    y = [1.2315800705061997, 1.2101034100511296, 1.2098813515761644, 1.3410773192274505, 1.3096426236095362, 1.1229851461263602, 1.1433442556886253, 1.13594555378647, 1.169571192466416, 1.1965954113494646, 1.1731341862876667, 0.6628774009630171, 0.6812566624400539, 0.7599046703715603, 0.8755964235620249, 0.8927872643173252, 1.0329743651993657, 1.0344229290135893, 0.17326535727747194, 0.15921407522940323, 0.1395618056292346, 0.1212674691522958, 0.36066493695079294, 0.3756996932078499, 0.5786200429469824, 0.5806288389611259, 1.23883126424959, 1.2368700649505766, 1.301980404879822, 1.30294048119965, 1.3354510595641904, 1.3341081819528156, 0.6834084886219435, 0.6716038318066616, 0.5917746969986665, 0.581204669633904, 0.7380113131325429, 0.7427804225644238, 0.8955474947023433, 0.9093458137046891, 1.0632284563407741, 1.0391989504470334, 0.31629897022741427, 0.42807350344071937, 0.4689862926579812, 0.6279712741371949, 0.6040925604683652, 0.7857403978409506, 0.7927798005851973]
    a, b = LombScargle([1, 2 ,3], [1, 2, 3]).autopower()
    print(a, b)

def main():
    l_gatspy()

if __name__ == "__main__":
    main()
