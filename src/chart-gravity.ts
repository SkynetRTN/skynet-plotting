"use strict";

import Chart from "chart.js/auto";
import Handsontable from "handsontable";

import { tableCommonOptions, colors } from "./config";
import {
  linkInputs,
  throttle,
  updateLabels,
  updateTableHeight,
  changeOptions,
} from "./util";
import { round } from "./my-math";

/**
 *  This function is for the moon of a planet.
 *  @returns {[Handsontable, Chart]}:
 */
export function gravity(): [Handsontable, Chart] {
  document
    .getElementById("input-div")
    .insertAdjacentHTML(
      "beforeend",
      '<form title="Gravitational Wave Diagram" id="gravity-form">\n' +
        '<div class="row">\n' +
        '<div class="col-sm-5 des">Merger Time (sec):</div>\n' +
        '<div class="col-sm-4 range"><input type="range" title="Merger" name="merge"></div>\n' +
        '<div class="col-sm-3 text"><input type="number" title="Merger" name="merge_num" class="field"></div>\n' +
        "</div>\n" +
        '<div class="row">\n' +
        '<div class="col-sm-5 des">Distance (Mpc):</div>\n' +
        '<div class="col-sm-4 range"><input type="range" title="Distance" name="dist"></div>\n' +
        '<div class="col-sm-3 text"><input type="number" title="Distance" name="dist_num" class="field"></div>\n' +
        "</div>\n" +
        '<div class="row">\n' +
        '<div class="col-sm-5 des">Inclination (Â°):</div>\n' +
        '<div class="col-sm-4 range"><input type="range" title="Inclination" name="inc"></div>\n' +
        '<div class="col-sm-3 text"><input type="number" title="Inclination" name="inc_num" class="field"></div>\n' +
        "</div>\n" +
        '<div class="row">\n' +
        '<div class="col-sm-5 des">Total Mass (solar):</div>\n' +
        '<div class="col-sm-4 range"><input type="range" title="Mass" name="mass"></div>\n' +
        '<div class="col-sm-3 text"><input type="number" title="Mass" name="mass_num" class="field"></div>\n' +
        "</div>\n" +
        '<div class="row">\n' +
        '<div class="col-sm-5 des">Mass Ratio:</div>\n' +
        '<div class="col-sm-4 range"><input type="range" title="Ratio" name="ratio"></div>\n' +
        '<div class="col-sm-3 text"><input type="number" title="Ratio" name="ratio_num" class="field"></div>\n' +
        "</div>\n" +
        "</form>\n" +
        '<form title="Filters" id="filter-form" style="padding-bottom: .5em">\n' +
        '<div class="row">\n' +
        '<div class="col-sm-6" style="color: black;">Remnant Mass:</div>\n' +
        '<div class="col-sm-6" style="color: black;">Mass to Energy:</div>\n' +
        "</div>\n" 
    );

  // Link each slider with corresponding text box
  const gravityForm = document.getElementById("gravity-form") as GravityForm;
  const filterForm = document.getElementById("filter-form") as ModelForm;
  linkInputs(gravityForm["merge"], gravityForm["merge_num"], 0, 100, 0.01, 50);
  linkInputs(
    gravityForm["dist"],
    gravityForm["dist_num"],
    10,
    10000,
    0.01,
    300,
    false,
    true,
    -100000000,
    100000000
  );
  linkInputs(gravityForm["inc"], gravityForm["inc_num"], 0, 90, 0.01, 0);
  linkInputs(
    gravityForm["mass"],
    gravityForm["mass_num"],
    2.5,
    250,
    0.01,
    25,
    true
  );
  linkInputs(
    gravityForm["ratio"],
    gravityForm["ratio_num"],
    1,
    10,
    0.01,
    1,
    true
  );

  const tableData = [
    {Time:	16.25	, Strain:	-0.291476046	},
    {Time:	16.25024009	, Strain:	-0.529312202	},
    {Time:	16.25047994	, Strain:	-0.780039999	},
    {Time:	16.25073004	, Strain:	-1.013380597	},
    {Time:	16.25096989	, Strain:	-1.201134742	},
    {Time:	16.25121999	, Strain:	-1.323766944	},
    {Time:	16.25146008	, Strain:	-1.374497237	},
    {Time:	16.25169992	, Strain:	-1.359799243	},
    {Time:	16.25195003	, Strain:	-1.296247202	},
    {Time:	16.25219011	, Strain:	-1.204598196	},
    {Time:	16.25243998	, Strain:	-1.102889082	},
    {Time:	16.25268006	, Strain:	-1.000829098	},
    {Time:	16.25291991	, Strain:	-0.897397954	},
    {Time:	16.25317001	, Strain:	-0.78241505	},
    {Time:	16.2534101	, Strain:	-0.641489324	},
    {Time:	16.25365996	, Strain:	-0.462624128	},
    {Time:	16.25390005	, Strain:	-0.242163137	},
    {Time:	16.25414991	, Strain:	0.011928634	},
    {Time:	16.25439	, Strain:	0.280346109	},
    {Time:	16.25463009	, Strain:	0.535988601	},
    {Time:	16.25487995	, Strain:	0.749746987	},
    {Time:	16.25512004	, Strain:	0.897155326	},
    {Time:	16.2553699	, Strain:	0.964282269	},
    {Time:	16.25560999	, Strain:	0.951267327	},
    {Time:	16.25585008	, Strain:	0.872480023	},
    {Time:	16.25609994	, Strain:	0.753261958	},
    {Time:	16.25634003	, Strain:	0.624160997	},
    {Time:	16.25658989	, Strain:	0.514122161	},
    {Time:	16.25682998	, Strain:	0.444164151	},
    {Time:	16.25708008	, Strain:	0.422802832	},
    {Time:	16.25731993	, Strain:	0.444141445	},
    {Time:	16.25756001	, Strain:	0.489196116	},
    {Time:	16.25781012	, Strain:	0.530481132	},
    {Time:	16.25804996	, Strain:	0.539082247	},
    {Time:	16.25830007	, Strain:	0.492680655	},
    {Time:	16.25853992	, Strain:	0.382570072	},
    {Time:	16.25878	, Strain:	0.217738353	},
    {Time:	16.2590301	, Strain:	0.024604854	},
    {Time:	16.25926995	, Strain:	-0.158017795	},
    {Time:	16.25952005	, Strain:	-0.287974286	},
    {Time:	16.2597599	, Strain:	-0.330885467	},
    {Time:	16.25999999	, Strain:	-0.270413997	},
    {Time:	16.26025009	, Strain:	-0.114493752	},
    {Time:	16.26048994	, Strain:	0.104680045	},
    {Time:	16.26074004	, Strain:	0.337164876	},
    {Time:	16.26097989	, Strain:	0.526605029	},
    {Time:	16.26122999	, Strain:	0.623455572	},
    {Time:	16.26147008	, Strain:	0.596809421	},
    {Time:	16.26170993	, Strain:	0.441985769	},
    {Time:	16.26196003	, Strain:	0.182064741	},
    {Time:	16.26220012	, Strain:	-0.137086739	},
    {Time:	16.26244998	, Strain:	-0.457228789	},
    {Time:	16.26269007	, Strain:	-0.721060633	},
    {Time:	16.26292992	, Strain:	-0.884931255	},
    {Time:	16.26318002	, Strain:	-0.927584984	},
    {Time:	16.2634201	, Strain:	-0.852989049	},
    {Time:	16.26366997	, Strain:	-0.687363294	},
    {Time:	16.26391006	, Strain:	-0.47217763	},
    {Time:	16.26415992	, Strain:	-0.255393215	},
    {Time:	16.26440001	, Strain:	-0.082774227	},
    {Time:	16.26464009	, Strain:	0.009606039	},
    {Time:	16.26488996	, Strain:	0.000963601	},
    {Time:	16.26513004	, Strain:	-0.111064383	},
    {Time:	16.26537991	, Strain:	-0.310147697	},
    {Time:	16.26561999	, Strain:	-0.563798081	},
    {Time:	16.26586008	, Strain:	-0.828158257	},
    {Time:	16.26610994	, Strain:	-1.054326132	},
    {Time:	16.26635003	, Strain:	-1.195652738	},
    {Time:	16.26659989	, Strain:	-1.215479379	},
    {Time:	16.26683998	, Strain:	-1.094393197	},
    {Time:	16.26708007	, Strain:	-0.835528679	},
    {Time:	16.26732993	, Strain:	-0.466208775	},
    {Time:	16.26757002	, Strain:	-0.034670801	},
    {Time:	16.26781988	, Strain:	0.398156194	},
    {Time:	16.26805997	, Strain:	0.770271362	},
    {Time:	16.26831007	, Strain:	1.030911519	},
    {Time:	16.26854992	, Strain:	1.150643609	},
    {Time:	16.26879001	, Strain:	1.126980035	},
    {Time:	16.26904011	, Strain:	0.984357865	},
    {Time:	16.26927996	, Strain:	0.768603636	},
    {Time:	16.26953006	, Strain:	0.537237955	},
    {Time:	16.26976991	, Strain:	0.347866646	},
    {Time:	16.27000999	, Strain:	0.247214458	},
    {Time:	16.2702601	, Strain:	0.262989233	},
    {Time:	16.27049994	, Strain:	0.399821335	},
    {Time:	16.27075005	, Strain:	0.639383828	},
    {Time:	16.27098989	, Strain:	0.943984902	},
    {Time:	16.27124	, Strain:	1.262695636	},
    {Time:	16.27148008	, Strain:	1.539224915	},
    {Time:	16.27171993	, Strain:	1.720848655	},
    {Time:	16.27197003	, Strain:	1.767459317	},
    {Time:	16.27220988	, Strain:	1.6592696	},
    {Time:	16.27245998	, Strain:	1.401256203	},
    {Time:	16.27270007	, Strain:	1.022607941	},
    {Time:	16.27293992	, Strain:	0.570584517	},
    {Time:	16.27319002	, Strain:	0.100038906	},
    {Time:	16.27343011	, Strain:	-0.338441561	},
    {Time:	16.27367997	, Strain:	-0.708180504	},
    {Time:	16.27392006	, Strain:	-0.991066741	},
    {Time:	16.27416992	, Strain:	-1.186363365	},
    {Time:	16.27441001	, Strain:	-1.30493176	},
    {Time:	16.2746501	, Strain:	-1.361510539	},
    {Time:	16.27489996	, Strain:	-1.367983795	},
    {Time:	16.27514005	, Strain:	-1.329919608	},
    {Time:	16.27538991	, Strain:	-1.247232991	},
    {Time:	16.27563	, Strain:	-1.118030125	},
    {Time:	16.27587008	, Strain:	-0.943418053	},
    {Time:	16.27611995	, Strain:	-0.731008051	},
    {Time:	16.27636003	, Strain:	-0.495791001	},
    {Time:	16.2766099	, Strain:	-0.258290242	},
    {Time:	16.27684999	, Strain:	-0.040840483	},
    {Time:	16.27709007	, Strain:	0.136722069	},
    {Time:	16.27733994	, Strain:	0.260710379	},
    {Time:	16.27758002	, Strain:	0.325704609	},
    {Time:	16.27782989	, Strain:	0.334881729	},
    {Time:	16.27806997	, Strain:	0.298961379	},
    {Time:	16.27832007	, Strain:	0.234440716	},
    {Time:	16.27855992	, Strain:	0.161435004	},
    {Time:	16.27880001	, Strain:	0.100914191	},
    {Time:	16.27905011	, Strain:	0.071143941	},
    {Time:	16.27928996	, Strain:	0.083767804	},
    {Time:	16.27954006	, Strain:	0.140566269	},
    {Time:	16.27977991	, Strain:	0.231992705	},
    {Time:	16.28002	, Strain:	0.33817041	},
    {Time:	16.2802701	, Strain:	0.432415693	},
    {Time:	16.28050995	, Strain:	0.486712665	},
    {Time:	16.28076005	, Strain:	0.478011199	},
    {Time:	16.2809999	, Strain:	0.39384643	},
    {Time:	16.28125	, Strain:	0.235712515	},
    {Time:	16.28149009	, Strain:	0.019040489	},
    {Time:	16.28172994	, Strain:	-0.230393437	},
    {Time:	16.28198004	, Strain:	-0.482554818	},
    {Time:	16.28221989	, Strain:	-0.709785401	},
    {Time:	16.28246999	, Strain:	-0.892077092	},
    {Time:	16.28271008	, Strain:	-1.019917617	},
    {Time:	16.28294992	, Strain:	-1.094548186	},
    {Time:	16.28320003	, Strain:	-1.125872514	},
    {Time:	16.28344011	, Strain:	-1.128350146	},
    {Time:	16.28368998	, Strain:	-1.115569452	},
    {Time:	16.28393006	, Strain:	-1.094896918	},
    {Time:	16.28416991	, Strain:	-1.064050019	},
    {Time:	16.28442001	, Strain:	-1.011045236	},
    {Time:	16.2846601	, Strain:	-0.917744611	},
    {Time:	16.28490996	, Strain:	-0.765813055	},
    {Time:	16.28515005	, Strain:	-0.543097296	},
    {Time:	16.28539991	, Strain:	-0.248568447	},
    {Time:	16.28564	, Strain:	0.105310582	},
    {Time:	16.28588009	, Strain:	0.493184966	},
    {Time:	16.28612995	, Strain:	0.88019458	},
    {Time:	16.28637004	, Strain:	1.227426339	},
    {Time:	16.2866199	, Strain:	1.498208262	},
    {Time:	16.28685999	, Strain:	1.663851711	},
    {Time:	16.28710008	, Strain:	1.707758705	},
    {Time:	16.28734994	, Strain:	1.627360915	},
    {Time:	16.28759003	, Strain:	1.433884131	},
    {Time:	16.28783989	, Strain:	1.150386952	},
    {Time:	16.28807998	, Strain:	0.808805149	},
    {Time:	16.28833008	, Strain:	0.446610651	},
    {Time:	16.28856993	, Strain:	0.103166794	},
    {Time:	16.28881001	, Strain:	-0.184601347	},
    {Time:	16.28906012	, Strain:	-0.387409473	},
    {Time:	16.28929996	, Strain:	-0.488960982	},
    {Time:	16.28955007	, Strain:	-0.489722348	},
    {Time:	16.28978992	, Strain:	-0.407207396	},
    {Time:	16.29003	, Strain:	-0.271839551	},
    {Time:	16.2902801	, Strain:	-0.119277974	},
    {Time:	16.29051995	, Strain:	0.018291923	},
    {Time:	16.29077005	, Strain:	0.118987557	},
    {Time:	16.2910099	, Strain:	0.174182444	},
    {Time:	16.29124999	, Strain:	0.187160676	},
    {Time:	16.29150009	, Strain:	0.168520418	},
    {Time:	16.29173994	, Strain:	0.130304936	},
    {Time:	16.29199004	, Strain:	0.081008074	},
    {Time:	16.29222989	, Strain:	0.023023182	},
    {Time:	16.29247999	, Strain:	-0.046892527	},
    {Time:	16.29272008	, Strain:	-0.134554319	},
    {Time:	16.29295993	, Strain:	-0.243820578	},
    {Time:	16.29321003	, Strain:	-0.372102999	},
    {Time:	16.29345012	, Strain:	-0.507453543	},
    {Time:	16.29369998	, Strain:	-0.628452704	},
    {Time:	16.29394007	, Strain:	-0.707400055	},
    {Time:	16.29417992	, Strain:	-0.716216197	},
    {Time:	16.29443002	, Strain:	-0.633418025	},
    {Time:	16.2946701	, Strain:	-0.450130908	},
    {Time:	16.29491997	, Strain:	-0.173578885	},
    {Time:	16.29516006	, Strain:	0.172543467	},
    {Time:	16.29540992	, Strain:	0.550608244	},
    {Time:	16.29565001	, Strain:	0.913975856	},
    {Time:	16.29589009	, Strain:	1.213741088	},
    {Time:	16.29613996	, Strain:	1.406564799	},
    {Time:	16.29638004	, Strain:	1.462436558	},
    {Time:	16.29662991	, Strain:	1.370875679	},
    {Time:	16.29686999	, Strain:	1.14412845	},
    {Time:	16.29711008	, Strain:	0.816393944	},
    {Time:	16.29735994	, Strain:	0.438872255	},
    {Time:	16.29760003	, Strain:	0.071294038	},
    {Time:	16.29784989	, Strain:	-0.228640927	},
    {Time:	16.29808998	, Strain:	-0.415952279	},
    {Time:	16.29833007	, Strain:	-0.466997868	},
    {Time:	16.29857993	, Strain:	-0.384044307	},
    {Time:	16.29882002	, Strain:	-0.194629909	},
    {Time:	16.29906988	, Strain:	0.054183882	},
    {Time:	16.29930997	, Strain:	0.305360327	},
    {Time:	16.29956007	, Strain:	0.503139981	},
    {Time:	16.29979992	, Strain:	0.603649354	},
    {Time:	16.30004001	, Strain:	0.582726188	},
    {Time:	16.30029011	, Strain:	0.439436137	},
    {Time:	16.30052996	, Strain:	0.194707225	},
    {Time:	16.30078006	, Strain:	-0.114388218	},
    {Time:	16.30101991	, Strain:	-0.443230079	},
    {Time:	16.30125999	, Strain:	-0.749113243	},
    {Time:	16.3015101	, Strain:	-0.999460141	},
    {Time:	16.30174994	, Strain:	-1.176926803	},
    {Time:	16.30200005	, Strain:	-1.280189398	},
    {Time:	16.30223989	, Strain:	-1.32027541	},
    {Time:	16.30249	, Strain:	-1.313650134	},
    {Time:	16.30273008	, Strain:	-1.274374561	},
    {Time:	16.30296993	, Strain:	-1.207942304	},
    {Time:	16.30322003	, Strain:	-1.10873517	},
    {Time:	16.30345988	, Strain:	-0.961802753	},
    {Time:	16.30370998	, Strain:	-0.748443736	},
    {Time:	16.30395007	, Strain:	-0.454192985	},
    {Time:	16.30418992	, Strain:	-0.077303189	},
    {Time:	16.30444002	, Strain:	0.364473807	},
    {Time:	16.30468011	, Strain:	0.831010889	},
    {Time:	16.30492997	, Strain:	1.262528525	},
    {Time:	16.30517006	, Strain:	1.588404007	},
    {Time:	16.30541992	, Strain:	1.740845061	},
    {Time:	16.30566001	, Strain:	1.670540998	},
    {Time:	16.3059001	, Strain:	1.360408324	},
    {Time:	16.30614996	, Strain:	0.83365797	},
    {Time:	16.30639005	, Strain:	0.153712038	},
    {Time:	16.30663991	, Strain:	-0.584410657	},
    {Time:	16.30688	, Strain:	-1.269515399	},
    {Time:	16.30712008	, Strain:	-1.793323821	},
    {Time:	16.30736995	, Strain:	-2.069611652	},
    {Time:	16.30761003	, Strain:	-2.049947799	},
    {Time:	16.3078599	, Strain:	-1.733164926	},
    {Time:	16.30809999	, Strain:	-1.166650991	},
    {Time:	16.30834007	, Strain:	-0.438941565	},
    {Time:	16.30858994	, Strain:	0.335276347	},
    {Time:	16.30883002	, Strain:	1.035087704	},
    {Time:	16.30907989	, Strain:	1.554386266	},
    {Time:	16.30931997	, Strain:	1.819824317	},
    {Time:	16.30957007	, Strain:	1.802090692	},
    {Time:	16.30980992	, Strain:	1.51838085	},
    {Time:	16.31005001	, Strain:	1.025828751	},
    {Time:	16.31030011	, Strain:	0.407753077	},
    {Time:	16.31053996	, Strain:	-0.243610778	},
    {Time:	16.31079006	, Strain:	-0.843432249	},
    {Time:	16.31102991	, Strain:	-1.325945509	},
    {Time:	16.31127	, Strain:	-1.649697836	},
    {Time:	16.3115201	, Strain:	-1.796898035	},
    {Time:	16.31175995	, Strain:	-1.768999902	},
    {Time:	16.31201005	, Strain:	-1.581157483	},
    {Time:	16.3122499	, Strain:	-1.257663438	},
    {Time:	16.3125	, Strain:	-0.829345175	},
    {Time:	16.31274009	, Strain:	-0.332599879	},
    {Time:	16.31297994	, Strain:	0.191183557	},
    {Time:	16.31323004	, Strain:	0.697146324	},
    {Time:	16.31346989	, Strain:	1.140010556	},
    {Time:	16.31371999	, Strain:	1.478368116	},
    {Time:	16.31396008	, Strain:	1.679533711	},
    {Time:	16.31419992	, Strain:	1.724327444	},
    {Time:	16.31445003	, Strain:	1.61113422	},
    {Time:	16.31469011	, Strain:	1.358277722	},
    {Time:	16.31493998	, Strain:	1.003404149	},
    {Time:	16.31518006	, Strain:	0.59876664	},
    {Time:	16.31541991	, Strain:	0.202421662	},
    {Time:	16.31567001	, Strain:	-0.132929675	},
    {Time:	16.3159101	, Strain:	-0.370371804	},
    {Time:	16.31615996	, Strain:	-0.495304421	},
    {Time:	16.31640005	, Strain:	-0.5162088	},
    {Time:	16.31664991	, Strain:	-0.459813533	},
    {Time:	16.31689	, Strain:	-0.36256175	},
    {Time:	16.31713009	, Strain:	-0.261050283	},
    {Time:	16.31737995	, Strain:	-0.183852349	},
    {Time:	16.31762004	, Strain:	-0.146265752	},
    {Time:	16.3178699	, Strain:	-0.148577466	},
    {Time:	16.31810999	, Strain:	-0.177715606	},
    {Time:	16.31835008	, Strain:	-0.211640824	},
    {Time:	16.31859994	, Strain:	-0.225356828	},
    {Time:	16.31884003	, Strain:	-0.19707854	},
    {Time:	16.31908989	, Strain:	-0.113181325	},
    {Time:	16.31932998	, Strain:	0.028884023	},
    {Time:	16.31958008	, Strain:	0.219879157	},
    {Time:	16.31981993	, Strain:	0.440105334	},
    {Time:	16.32006001	, Strain:	0.66252737	},
    {Time:	16.32031012	, Strain:	0.857312982	},
    {Time:	16.32054996	, Strain:	0.997163461	},
    {Time:	16.32080007	, Strain:	1.062630265	},
    {Time:	16.32103992	, Strain:	1.046477636	},
    {Time:	16.32128	, Strain:	0.955994835	},
    {Time:	16.3215301	, Strain:	0.812189559	},
    {Time:	16.32176995	, Strain:	0.645337805	},
    {Time:	16.32202005	, Strain:	0.487487965	},
    {Time:	16.3222599	, Strain:	0.363828478	},
    {Time:	16.32249999	, Strain:	0.28563024	},
    {Time:	16.32275009	, Strain:	0.247251518	},
    {Time:	16.32298994	, Strain:	0.228505099	},
    {Time:	16.32324004	, Strain:	0.201985215	},
    {Time:	16.32347989	, Strain:	0.143235396	},
    {Time:	16.32372999	, Strain:	0.040441127	},
    {Time:	16.32397008	, Strain:	-0.099810902	},
    {Time:	16.32420993	, Strain:	-0.253016817	},
    {Time:	16.32446003	, Strain:	-0.383670473	},
    {Time:	16.32470012	, Strain:	-0.45647854	},
    {Time:	16.32494998	, Strain:	-0.448134744	},
    {Time:	16.32519007	, Strain:	-0.355666277	},
    {Time:	16.32542992	, Strain:	-0.198591985	},
    {Time:	16.32568002	, Strain:	-0.014301108	},
    {Time:	16.3259201	, Strain:	0.151727333	},
    {Time:	16.32616997	, Strain:	0.257766444	},
    {Time:	16.32641006	, Strain:	0.276229152	},
    {Time:	16.32665992	, Strain:	0.199692492	},
    {Time:	16.32690001	, Strain:	0.041086379	},
    {Time:	16.32714009	, Strain:	-0.171553518	},
    {Time:	16.32738996	, Strain:	-0.403724732	},
    {Time:	16.32763004	, Strain:	-0.623634681	},
    {Time:	16.32787991	, Strain:	-0.80925868	},
    {Time:	16.32811999	, Strain:	-0.951613806	},
    {Time:	16.32836008	, Strain:	-1.053985701	},
    {Time:	16.32860994	, Strain:	-1.128145759	},
    {Time:	16.32885003	, Strain:	-1.189259457	},
    {Time:	16.32909989	, Strain:	-1.251007787	},
    {Time:	16.32933998	, Strain:	-1.321740181	},
    {Time:	16.32958007	, Strain:	-1.401846073	},
    {Time:	16.32982993	, Strain:	-1.48238469	},
    {Time:	16.33007002	, Strain:	-1.545271961	},
    {Time:	16.33031988	, Strain:	-1.565528709	},
    {Time:	16.33055997	, Strain:	-1.515802563	},
    {Time:	16.33081007	, Strain:	-1.372538204	},
    {Time:	16.33104992	, Strain:	-1.122265151	},
    {Time:	16.33129001	, Strain:	-0.76618824	},
    {Time:	16.33154011	, Strain:	-0.321833276	},
    {Time:	16.33177996	, Strain:	0.17853833	},
    {Time:	16.33203006	, Strain:	0.692269549	},
    {Time:	16.33226991	, Strain:	1.172541928	},
    {Time:	16.33250999	, Strain:	1.575423585	},
    {Time:	16.3327601	, Strain:	1.866382916	},
    {Time:	16.33299994	, Strain:	2.024778655	},
    {Time:	16.33325005	, Strain:	2.045238042	},
    {Time:	16.33348989	, Strain:	1.935845693	},
    {Time:	16.33374	, Strain:	1.714220469	},
    {Time:	16.33398008	, Strain:	1.403261524	},
    {Time:	16.33421993	, Strain:	1.028230005	},
    {Time:	16.33447003	, Strain:	0.615907321	},
    {Time:	16.33470988	, Strain:	0.195301725	},
    {Time:	16.33495998	, Strain:	-0.201542528	},
    {Time:	16.33520007	, Strain:	-0.540215053	},
    {Time:	16.33543992	, Strain:	-0.787042867	},
    {Time:	16.33569002	, Strain:	-0.914475642	},
    {Time:	16.33593011	, Strain:	-0.907448235	},
    {Time:	16.33617997	, Strain:	-0.768726951	},
    {Time:	16.33642006	, Strain:	-0.521332119	},
    {Time:	16.33666992	, Strain:	-0.206868771	},
    {Time:	16.33691001	, Strain:	0.120382071	},
    {Time:	16.3371501	, Strain:	0.402697355	},
    {Time:	16.33739996	, Strain:	0.589586602	},
    {Time:	16.33764005	, Strain:	0.647448671	},
    {Time:	16.33788991	, Strain:	0.565905984	},
    {Time:	16.33813	, Strain:	0.359341929	},
    {Time:	16.33837008	, Strain:	0.063304728	},
    {Time:	16.33861995	, Strain:	-0.273400285	},
    {Time:	16.33886003	, Strain:	-0.599067011	},
    {Time:	16.3391099	, Strain:	-0.869325497	},
    {Time:	16.33934999	, Strain:	-1.054652283	},
    {Time:	16.33959007	, Strain:	-1.143390091	},
    {Time:	16.33983994	, Strain:	-1.140077325	},
    {Time:	16.34008002	, Strain:	-1.060509854	},
    {Time:	16.34032989	, Strain:	-0.925760088	},
    {Time:	16.34056997	, Strain:	-0.757022511	},
    {Time:	16.34082007	, Strain:	-0.572213617	},
    {Time:	16.34105992	, Strain:	-0.384506143	},
    {Time:	16.34130001	, Strain:	-0.202574031	},
    {Time:	16.34155011	, Strain:	-0.032017357	},
    {Time:	16.34178996	, Strain:	0.122797975	},
    {Time:	16.34204006	, Strain:	0.257277426	},
    {Time:	16.34227991	, Strain:	0.366163719	},
    {Time:	16.34252	, Strain:	0.444538158	},
    {Time:	16.3427701	, Strain:	0.490182681	},
    {Time:	16.34300995	, Strain:	0.50648993	},
    {Time:	16.34326005	, Strain:	0.504467551	},
    {Time:	16.3434999	, Strain:	0.502299129	},
    {Time:	16.34375	, Strain:	0.521645457	},
    {Time:	16.34399009	, Strain:	0.58128919	},
    {Time:	16.34422994	, Strain:	0.690225955	},
    {Time:	16.34448004	, Strain:	0.842973808	},
    {Time:	16.34471989	, Strain:	1.019231884	},
    {Time:	16.34496999	, Strain:	1.188409766	},
    {Time:	16.34521008	, Strain:	1.317743108	},
    {Time:	16.34544992	, Strain:	1.381423319	},
    {Time:	16.34570003	, Strain:	1.367890679	},
    {Time:	16.34594011	, Strain:	1.283225369	},
    {Time:	16.34618998	, Strain:	1.149873903	},
    {Time:	16.34643006	, Strain:	1.001091452	},
    {Time:	16.34666991	, Strain:	0.87232334	},
    {Time:	16.34692001	, Strain:	0.791535971	},
    {Time:	16.3471601	, Strain:	0.771134604	},
    {Time:	16.34740996	, Strain:	0.804009107	},
    {Time:	16.34765005	, Strain:	0.865102565	},
    {Time:	16.34789991	, Strain:	0.918081708	},
    {Time:	16.34814	, Strain:	0.924997624	},
    {Time:	16.34838009	, Strain:	0.855985819	},
    {Time:	16.34862995	, Strain:	0.696404058	},
    {Time:	16.34887004	, Strain:	0.450027495	},
    {Time:	16.3491199	, Strain:	0.138195181	},
    {Time:	16.34935999	, Strain:	-0.204469088	},
    {Time:	16.34960008	, Strain:	-0.536872399	},
    {Time:	16.34984994	, Strain:	-0.819670743	},
    {Time:	16.35009003	, Strain:	-1.023363211	},
    {Time:	16.35033989	, Strain:	-1.134487435	},
    {Time:	16.35057998	, Strain:	-1.158364398	},
    {Time:	16.35083008	, Strain:	-1.117535089	},
    {Time:	16.35106993	, Strain:	-1.046018237	},
    {Time:	16.35131001	, Strain:	-0.980634751	},
    {Time:	16.35156012	, Strain:	-0.951617425	},
    {Time:	16.35179996	, Strain:	-0.975090789	},
    {Time:	16.35205007	, Strain:	-1.04942544	},
    {Time:	16.35228992	, Strain:	-1.15617131	},
    {Time:	16.35253	, Strain:	-1.264965543	},
    {Time:	16.3527801	, Strain:	-1.341013076	},
    {Time:	16.35301995	, Strain:	-1.353425113	},
    {Time:	16.35327005	, Strain:	-1.282634433	},
    {Time:	16.3535099	, Strain:	-1.125215277	},
    {Time:	16.35374999	, Strain:	-0.894851754	},
    {Time:	16.35400009	, Strain:	-0.619075208	},
    {Time:	16.35423994	, Strain:	-0.332622531	},
    {Time:	16.35449004	, Strain:	-0.069378002	},
    {Time:	16.35472989	, Strain:	0.14471138	},
    {Time:	16.35497999	, Strain:	0.295801636	},
    {Time:	16.35522008	, Strain:	0.382483439	},
    {Time:	16.35545993	, Strain:	0.412558736	},
    {Time:	16.35571003	, Strain:	0.397566315	},
    {Time:	16.35595012	, Strain:	0.346919764	},
    {Time:	16.35619998	, Strain:	0.26347294	},
    {Time:	16.35644007	, Strain:	0.141855459	},
    {Time:	16.35667992	, Strain:	-0.029703706	},
    {Time:	16.35693002	, Strain:	-0.264103469	},
    {Time:	16.3571701	, Strain:	-0.567691345	},
    {Time:	16.35741997	, Strain:	-0.932299689	},
    {Time:	16.35766006	, Strain:	-1.329723543	},
    {Time:	16.35790992	, Strain:	-1.711036711	},
    {Time:	16.35815001	, Strain:	-2.011976239	},
    {Time:	16.35839009	, Strain:	-2.164029951	},
    {Time:	16.35863996	, Strain:	-2.109136048	},
    {Time:	16.35888004	, Strain:	-1.814470863	},
    {Time:	16.35912991	, Strain:	-1.283381977	},
    {Time:	16.35936999	, Strain:	-0.559453932	},
    {Time:	16.35961008	, Strain:	0.277528499	},
    {Time:	16.35985994	, Strain:	1.123044525	},
    {Time:	16.36010003	, Strain:	1.864415727	},
    {Time:	16.36034989	, Strain:	2.399158927	},
    {Time:	16.36058998	, Strain:	2.651676238	},
    {Time:	16.36083007	, Strain:	2.585539057	},
    {Time:	16.36107993	, Strain:	2.209557856	},
    {Time:	16.36132002	, Strain:	1.576678153	},
    {Time:	16.36156988	, Strain:	0.775703346	},
    {Time:	16.36180997	, Strain:	-0.082849333	},
    {Time:	16.36206007	, Strain:	-0.884143344	},
    {Time:	16.36229992	, Strain:	-1.526437539	},
    {Time:	16.36254001	, Strain:	-1.935605648	},
    {Time:	16.36279011	, Strain:	-2.074648986	},
    {Time:	16.36302996	, Strain:	-1.946952738	},
    {Time:	16.36328006	, Strain:	-1.592939327	},
    {Time:	16.36351991	, Strain:	-1.080779801	},
    {Time:	16.36375999	, Strain:	-0.49281882	},
    {Time:	16.3640101	, Strain:	0.089826007	},
    {Time:	16.36424994	, Strain:	0.601600746	},
    {Time:	16.36450005	, Strain:	1.003037763	},
    {Time:	16.36473989	, Strain:	1.28543831	},
    {Time:	16.36499	, Strain:	1.468803789	},
    {Time:	16.36523008	, Strain:	1.593443214	},
    {Time:	16.36546993	, Strain:	1.707125828	},
    {Time:	16.36572003	, Strain:	1.850870507	},
    {Time:	16.36595988	, Strain:	2.046966182	},
    {Time:	16.36620998	, Strain:	2.292264311	},
    {Time:	16.36645007	, Strain:	2.558266921	},
    {Time:	16.36668992	, Strain:	2.797610287	},
    {Time:	16.36694002	, Strain:	2.954985306	},
    {Time:	16.36718011	, Strain:	2.979777065	},
    {Time:	16.36742997	, Strain:	2.837619012	},
    {Time:	16.36767006	, Strain:	2.518398284	},
    {Time:	16.36791992	, Strain:	2.039039792	},
    {Time:	16.36816001	, Strain:	1.440644022	},
    {Time:	16.3684001	, Strain:	0.780912291	},
    {Time:	16.36864996	, Strain:	0.123807961	},
    {Time:	16.36889005	, Strain:	-0.47110387	},
    {Time:	16.36913991	, Strain:	-0.957227708	},
    {Time:	16.36938	, Strain:	-1.30566541	},
    {Time:	16.36962008	, Strain:	-1.505613836	},
    {Time:	16.36986995	, Strain:	-1.56139336	},
    {Time:	16.37011003	, Strain:	-1.488035776	},
    {Time:	16.3703599	, Strain:	-1.30741938	},
    {Time:	16.37059999	, Strain:	-1.046128973	},
    {Time:	16.37084007	, Strain:	-0.735004903	},
    {Time:	16.37108994	, Strain:	-0.409310585	},
    {Time:	16.37133002	, Strain:	-0.107936311	},
    {Time:	16.37157989	, Strain:	0.12977787	},
    {Time:	16.37181997	, Strain:	0.270017873	},
    {Time:	16.37207007	, Strain:	0.291990618	},
    {Time:	16.37230992	, Strain:	0.194122668	},
    {Time:	16.37255001	, Strain:	-0.004056945	},
    {Time:	16.37280011	, Strain:	-0.265838898	},
    {Time:	16.37303996	, Strain:	-0.546144119	},
    {Time:	16.37329006	, Strain:	-0.802408635	},
    {Time:	16.37352991	, Strain:	-1.004166147	},
    {Time:	16.37377	, Strain:	-1.138658639	},
    {Time:	16.3740201	, Strain:	-1.211257516	},
    {Time:	16.37425995	, Strain:	-1.241123003	},
    {Time:	16.37451005	, Strain:	-1.253840831	},
    {Time:	16.3747499	, Strain:	-1.273356152	},
    {Time:	16.375	, Strain:	-1.315373429	},
    {Time:	16.37524009	, Strain:	-1.383765276	},
    {Time:	16.37547994	, Strain:	-1.470569377	},
    {Time:	16.37573004	, Strain:	-1.55899899	},
    {Time:	16.37596989	, Strain:	-1.628030073	},
    {Time:	16.37621999	, Strain:	-1.657041474	},
    {Time:	16.37646008	, Strain:	-1.629594991	},
    {Time:	16.37669992	, Strain:	-1.536173337	},
    {Time:	16.37695003	, Strain:	-1.376019386	},
    {Time:	16.37719011	, Strain:	-1.158069293	},
    {Time:	16.37743998	, Strain:	-0.9007183	},
    {Time:	16.37768006	, Strain:	-0.630181548	},
    {Time:	16.37791991	, Strain:	-0.377459918	},
    {Time:	16.37817001	, Strain:	-0.17409155	},
    {Time:	16.3784101	, Strain:	-0.047007613	},
    {Time:	16.37865996	, Strain:	-0.013236893	},
    {Time:	16.37890005	, Strain:	-0.075750323	},
    {Time:	16.37914991	, Strain:	-0.221719766	},
    {Time:	16.37939	, Strain:	-0.423668271	},
    {Time:	16.37963009	, Strain:	-0.643058169	},
    {Time:	16.37987995	, Strain:	-0.835486643	},
    {Time:	16.38012004	, Strain:	-0.956795644	},
    {Time:	16.3803699	, Strain:	-0.9695248	},
    {Time:	16.38060999	, Strain:	-0.848949295	},
    {Time:	16.38085008	, Strain:	-0.587661322	},
    {Time:	16.38109994	, Strain:	-0.197667209	},
    {Time:	16.38134003	, Strain:	0.290532888	},
    {Time:	16.38158989	, Strain:	0.831646752	},
    {Time:	16.38182998	, Strain:	1.371292296	},
    {Time:	16.38208008	, Strain:	1.852898752	},
    {Time:	16.38231993	, Strain:	2.22523129	},
    {Time:	16.38256001	, Strain:	2.449925702	},
    {Time:	16.38281012	, Strain:	2.507996138	},
    {Time:	16.38304996	, Strain:	2.40382757	},
    {Time:	16.38330007	, Strain:	2.165167203	},
    {Time:	16.38353992	, Strain:	1.838354382	},
    {Time:	16.38378	, Strain:	1.479368883	},
    {Time:	16.3840301	, Strain:	1.142725685	},
    {Time:	16.38426995	, Strain:	0.871108777	},
    {Time:	16.38452005	, Strain:	0.688487949	},
    {Time:	16.3847599	, Strain:	0.598375757	},
    {Time:	16.38499999	, Strain:	0.587251931	},
    {Time:	16.38525009	, Strain:	0.631534514	},
    {Time:	16.38548994	, Strain:	0.705419189	},
    {Time:	16.38574004	, Strain:	0.786924209	},
    {Time:	16.38597989	, Strain:	0.860620978	},
    {Time:	16.38622999	, Strain:	0.917270929	},
    {Time:	16.38647008	, Strain:	0.9519799	},
    {Time:	16.38670993	, Strain:	0.962766844	},
    {Time:	16.38696003	, Strain:	0.950626266	},
    {Time:	16.38720012	, Strain:	0.92085018	},
    {Time:	16.38744998	, Strain:	0.884295163	},
    {Time:	16.38769007	, Strain:	0.856984661	},
    {Time:	16.38792992	, Strain:	0.85704479	},
    {Time:	16.38818002	, Strain:	0.899138812	},
    {Time:	16.3884201	, Strain:	0.987811069	},
    {Time:	16.38866997	, Strain:	1.112036689	},
    {Time:	16.38891006	, Strain:	1.243373148	},
    {Time:	16.38915992	, Strain:	1.339193157	},
    {Time:	16.38940001	, Strain:	1.350776783	},
    {Time:	16.38964009	, Strain:	1.234267062	},
    {Time:	16.38988996	, Strain:	0.961488293	},
    {Time:	16.39013004	, Strain:	0.527771188	},
    {Time:	16.39037991	, Strain:	-0.04507004	},
    {Time:	16.39061999	, Strain:	-0.711174118	},
    {Time:	16.39086008	, Strain:	-1.407863573	},
    {Time:	16.39110994	, Strain:	-2.066116259	},
    {Time:	16.39135003	, Strain:	-2.622083345	},
    {Time:	16.39159989	, Strain:	-3.027197046	},
    {Time:	16.39183998	, Strain:	-3.254698539	},
    {Time:	16.39208007	, Strain:	-3.301396338	},
    {Time:	16.39232993	, Strain:	-3.184952584	},
    {Time:	16.39257002	, Strain:	-2.938330361	},
    {Time:	16.39281988	, Strain:	-2.603476192	},
    {Time:	16.39305997	, Strain:	-2.225667441	},
    {Time:	16.39331007	, Strain:	-1.848818016	},
    {Time:	16.39354992	, Strain:	-1.511346467	},
    {Time:	16.39379001	, Strain:	-1.242430984	},
    {Time:	16.39404011	, Strain:	-1.059144422	},
    {Time:	16.39427996	, Strain:	-0.96523416	},
    {Time:	16.39453006	, Strain:	-0.951918236	},
    {Time:	16.39476991	, Strain:	-1.000467698	},
    {Time:	16.39500999	, Strain:	-1.086012818	},
    {Time:	16.3952601	, Strain:	-1.181978682	},
    {Time:	16.39549994	, Strain:	-1.264569772	},
    {Time:	16.39575005	, Strain:	-1.316571561	},
    {Time:	16.39598989	, Strain:	-1.329492568	},
    {Time:	16.39624	, Strain:	-1.303122307	},
    {Time:	16.39648008	, Strain:	-1.242261052	},
    {Time:	16.39671993	, Strain:	-1.151537487	},
    {Time:	16.39697003	, Strain:	-1.030291511	},
    {Time:	16.39720988	, Strain:	-0.869811603	},
    {Time:	16.39745998	, Strain:	-0.654412612	},
    {Time:	16.39770007	, Strain:	-0.366177315	},
    {Time:	16.39793992	, Strain:	0.008422658	},
    {Time:	16.39819002	, Strain:	0.472414005	},
    {Time:	16.39843011	, Strain:	1.01454169	},
    {Time:	16.39867997	, Strain:	1.60860947	},
    {Time:	16.39892006	, Strain:	2.215917233	},
    {Time:	16.39916992	, Strain:	2.790264789	},
    {Time:	16.39941001	, Strain:	3.284584243	},
    {Time:	16.3996501	, Strain:	3.657948448	},
    {Time:	16.39989996	, Strain:	3.881612655	},
    {Time:	16.40014005	, Strain:	3.942976037	},
    {Time:	16.40038991	, Strain:	3.846899313	},
    {Time:	16.40063	, Strain:	3.614443725	},
    {Time:	16.40087008	, Strain:	3.279454368	},
    {Time:	16.40111995	, Strain:	2.883509672	},
    {Time:	16.40136003	, Strain:	2.469929165	},
    {Time:	16.4016099	, Strain:	2.077808988	},
    {Time:	16.40184999	, Strain:	1.737108142	},
    {Time:	16.40209007	, Strain:	1.465493577	},
    {Time:	16.40233994	, Strain:	1.267182581	},
    {Time:	16.40258002	, Strain:	1.133646443	},
    {Time:	16.40282989	, Strain:	1.045851185	},
    {Time:	16.40306997	, Strain:	0.977660203	},
    {Time:	16.40332007	, Strain:	0.899966127	},
    {Time:	16.40355992	, Strain:	0.784967988	},
    {Time:	16.40380001	, Strain:	0.609906914	},
    {Time:	16.40405011	, Strain:	0.359739387	},
    {Time:	16.40428996	, Strain:	0.028609917	},
    {Time:	16.40454006	, Strain:	-0.379725203	},
    {Time:	16.40477991	, Strain:	-0.852362075	},
    {Time:	16.40502	, Strain:	-1.368578434	},
    {Time:	16.4052701	, Strain:	-1.90203549	},
    {Time:	16.40550995	, Strain:	-2.423707539	},
    {Time:	16.40576005	, Strain:	-2.90521051	},
    {Time:	16.4059999	, Strain:	-3.322092195	},
    {Time:	16.40625	, Strain:	-3.656506494	},
    {Time:	16.40649009	, Strain:	-3.898495605	},
    {Time:	16.40672994	, Strain:	-4.045212552	},
    {Time:	16.40698004	, Strain:	-4.098181567	},
    {Time:	16.40721989	, Strain:	-4.059771287	},
    {Time:	16.40746999	, Strain:	-3.930588911	},
    {Time:	16.40771008	, Strain:	-3.709012166	},
    {Time:	16.40794992	, Strain:	-3.392898505	},
    {Time:	16.40820003	, Strain:	-2.98247007	},
    {Time:	16.40844011	, Strain:	-2.483094566	},
    {Time:	16.40868998	, Strain:	-1.907069113	},
    {Time:	16.40893006	, Strain:	-1.273961406	},
    {Time:	16.40916991	, Strain:	-0.609241634	},
    {Time:	16.40942001	, Strain:	0.058915432	},
    {Time:	16.4096601	, Strain:	0.704310771	},
    {Time:	16.40990996	, Strain:	1.307737883	},
    {Time:	16.41015005	, Strain:	1.860535804	},
    {Time:	16.41039991	, Strain:	2.365006507	},
    {Time:	16.41064	, Strain:	2.831087482	},
    {Time:	16.41088009	, Strain:	3.270117403	},
    {Time:	16.41112995	, Strain:	3.687618896	},
    {Time:	16.41137004	, Strain:	4.077329006	},
    {Time:	16.4116199	, Strain:	4.418233254	},
    {Time:	16.41185999	, Strain:	4.675410871	},
    {Time:	16.41210008	, Strain:	4.804530236	},
    {Time:	16.41234994	, Strain:	4.759134203	},
    {Time:	16.41259003	, Strain:	4.49936787	},
    {Time:	16.41283989	, Strain:	4.000435887	},
    {Time:	16.41307998	, Strain:	3.259058087	},
    {Time:	16.41333008	, Strain:	2.296720029	},
    {Time:	16.41356993	, Strain:	1.159254801	},
    {Time:	16.41381001	, Strain:	-0.087255318	},
    {Time:	16.41406012	, Strain:	-1.364008971	},
    {Time:	16.41429996	, Strain:	-2.589577277	},
    {Time:	16.41455007	, Strain:	-3.690584979	},
    {Time:	16.41478992	, Strain:	-4.610164215	},
    {Time:	16.41503	, Strain:	-5.311712684	},
    {Time:	16.4152801	, Strain:	-5.777124712	},
    {Time:	16.41551995	, Strain:	-6.000642136	},
    {Time:	16.41577005	, Strain:	-5.980788757	},
    {Time:	16.4160099	, Strain:	-5.713320328	},
    {Time:	16.41624999	, Strain:	-5.187999485	},
    {Time:	16.41650009	, Strain:	-4.391241442	},
    {Time:	16.41673994	, Strain:	-3.315049803	},
    {Time:	16.41699004	, Strain:	-1.97039956	},
    {Time:	16.41722989	, Strain:	-0.4011216	},
    {Time:	16.41747999	, Strain:	1.306679447	},
    {Time:	16.41772008	, Strain:	3.024065209	},
    {Time:	16.41795993	, Strain:	4.589846107	},
    {Time:	16.41821003	, Strain:	5.831497858	},
    {Time:	16.41845012	, Strain:	6.592461204	},
    {Time:	16.41869998	, Strain:	6.759839846	},
    {Time:	16.41894007	, Strain:	6.286396941	},
    {Time:	16.41917992	, Strain:	5.202458487	},
    {Time:	16.41943002	, Strain:	3.615900527	},
    {Time:	16.4196701	, Strain:	1.70068705	},
    {Time:	16.41991997	, Strain:	-0.324112673	},
    {Time:	16.42016006	, Strain:	-2.222036867	},
    {Time:	16.42040992	, Strain:	-3.770139371	},
    {Time:	16.42065001	, Strain:	-4.788865897	},
    {Time:	16.42089009	, Strain:	-5.166464203	},
    {Time:	16.42113996	, Strain:	-4.874129866	},
    {Time:	16.42138004	, Strain:	-3.969432028	},
    {Time:	16.42162991	, Strain:	-2.58728452	},
    {Time:	16.42186999	, Strain:	-0.919675522	},
    {Time:	16.42211008	, Strain:	0.812689505	},
    {Time:	16.42235994	, Strain:	2.392287339	},
    {Time:	16.42260003	, Strain:	3.635199377	},
    {Time:	16.42284989	, Strain:	4.415306276	},
    {Time:	16.42308998	, Strain:	4.67838749	},
    {Time:	16.42333007	, Strain:	4.444010225	},
    {Time:	16.42357993	, Strain:	3.795619415	},
    {Time:	16.42382002	, Strain:	2.861652818	},
    {Time:	16.42406988	, Strain:	1.791887061	},
    {Time:	16.42430997	, Strain:	0.733392507	},
    {Time:	16.42456007	, Strain:	-0.190168974	},
    {Time:	16.42479992	, Strain:	-0.893169613	},
    {Time:	16.42504001	, Strain:	-1.334972659	},
    {Time:	16.42529011	, Strain:	-1.518933552	},
    {Time:	16.42552996	, Strain:	-1.484555997	},
    {Time:	16.42578006	, Strain:	-1.2950668	},
    {Time:	16.42601991	, Strain:	-1.023261162	},
    {Time:	16.42625999	, Strain:	-0.738421459	},
    {Time:	16.4265101	, Strain:	-0.49649592	},
    {Time:	16.42674994	, Strain:	-0.334674734	},
    {Time:	16.42700005	, Strain:	-0.270326926	},
    {Time:	16.42723989	, Strain:	-0.303344432	},
    {Time:	16.42749	, Strain:	-0.420464493	},
    {Time:	16.42773008	, Strain:	-0.60011128	},
    {Time:	16.42796993	, Strain:	-0.816676059	},
    {Time:	16.42822003	, Strain:	-1.043753857	},
    {Time:	16.42845988	, Strain:	-1.256351483	},
    {Time:	16.42870998	, Strain:	-1.432301782	},
    {Time:	16.42895007	, Strain:	-1.553095362	},
    {Time:	16.42918992	, Strain:	-1.604214718	},
    {Time:	16.42944002	, Strain:	-1.575064686	},
    {Time:	16.42968011	, Strain:	-1.458860207	},
    {Time:	16.42992997	, Strain:	-1.25306418	},
    {Time:	16.43017006	, Strain:	-0.96072587	},
    {Time:	16.43041992	, Strain:	-0.592394308	},
    {Time:	16.43066001	, Strain:	-0.167706311	},
    {Time:	16.4309001	, Strain:	0.284326073	},
    {Time:	16.43114996	, Strain:	0.726963502	},
    {Time:	16.43139005	, Strain:	1.119456596	},
    {Time:	16.43163991	, Strain:	1.422400283	},
    {Time:	16.43188	, Strain:	1.603738807	},
    {Time:	16.43212008	, Strain:	1.644115761	},
    {Time:	16.43236995	, Strain:	1.540356895	},
    {Time:	16.43261003	, Strain:	1.306353437	},
    {Time:	16.4328599	, Strain:	0.971267439	},
    {Time:	16.43309999	, Strain:	0.575461313	},
    {Time:	16.43334007	, Strain:	0.164717488	},
    {Time:	16.43358994	, Strain:	-0.2165311	},
    {Time:	16.43383002	, Strain:	-0.531885734	},
    {Time:	16.43407989	, Strain:	-0.758316768	},
    {Time:	16.43431997	, Strain:	-0.889170876	},
    {Time:	16.43457007	, Strain:	-0.934361765	},
    {Time:	16.43480992	, Strain:	-0.917615369	},
    {Time:	16.43505001	, Strain:	-0.871030925	},
    {Time:	16.43530011	, Strain:	-0.827852729	},
    {Time:	16.43553996	, Strain:	-0.814957412	},
    {Time:	16.43579006	, Strain:	-0.846709169	},
    {Time:	16.43602991	, Strain:	-0.921464154	},
    {Time:	16.43627	, Strain:	-1.021406034	},
    {Time:	16.4365201	, Strain:	-1.115788403	},
    {Time:	16.43675995	, Strain:	-1.167043988	},
    {Time:	16.43701005	, Strain:	-1.13861041	},
    {Time:	16.4372499	, Strain:	-1.002918869	},
    {Time:	16.4375	, Strain:	-0.747977947	},
    {Time:	16.43774009	, Strain:	-0.381308427	},
    {Time:	16.43797994	, Strain:	0.069562255	},
    {Time:	16.43823004	, Strain:	0.560380394	},
    {Time:	16.43846989	, Strain:	1.036981263	},
    {Time:	16.43871999	, Strain:	1.444583634	},
    {Time:	16.43896008	, Strain:	1.7376931	},
    {Time:	16.43919992	, Strain:	1.888385815	},
    {Time:	16.43945003	, Strain:	1.891039547	},
    {Time:	16.43969011	, Strain:	1.762402725	},
    {Time:	16.43993998	, Strain:	1.537035531	},
    {Time:	16.44018006	, Strain:	1.259361343	},
    {Time:	16.44041991	, Strain:	0.97442899	},
    {Time:	16.44067001	, Strain:	0.719615217	},
    {Time:	16.4409101	, Strain:	0.518896472	},
    {Time:	16.44115996	, Strain:	0.38044429	},
    {Time:	16.44140005	, Strain:	0.29757703	},
    {Time:	16.44164991	, Strain:	0.252585299	},
    {Time:	16.44189	, Strain:	0.222509087	},
    {Time:	16.44213009	, Strain:	0.185554409	},
    {Time:	16.44237995	, Strain:	0.126632748	},
    {Time:	16.44262004	, Strain:	0.040709619	},
    {Time:	16.4428699	, Strain:	-0.066675822	},
    {Time:	16.44310999	, Strain:	-0.181518975	},
    {Time:	16.44335008	, Strain:	-0.285323798	},
    {Time:	16.44359994	, Strain:	-0.359989715	},
    {Time:	16.44384003	, Strain:	-0.392570313	},
    {Time:	16.44408989	, Strain:	-0.378743323	},
    {Time:	16.44432998	, Strain:	-0.323928196	},
    {Time:	16.44458008	, Strain:	-0.241578787	},
    {Time:	16.44481993	, Strain:	-0.149150322	},
    {Time:	16.44506001	, Strain:	-0.063124334	},
    {Time:	16.44531012	, Strain:	0.00518292	},
    {Time:	16.44554996	, Strain:	0.051649701	},
    {Time:	16.44580007	, Strain:	0.078684211	},
    {Time:	16.44603992	, Strain:	0.092336328	},
    {Time:	16.44628	, Strain:	0.098468914	},
    {Time:	16.4465301	, Strain:	0.09962839	},
    {Time:	16.44676995	, Strain:	0.093990136	},
    {Time:	16.44702005	, Strain:	0.076863343	},
    {Time:	16.4472599	, Strain:	0.044001452	},
    {Time:	16.44749999	, Strain:	-0.005006465	},
    {Time:	16.44775009	, Strain:	-0.065057116	},
    {Time:	16.44798994	, Strain:	-0.126426494	},
    {Time:	16.44824004	, Strain:	-0.177781874	},
    {Time:	16.44847989	, Strain:	-0.209987772	},
    {Time:	16.44872999	, Strain:	-0.219231158	},
    {Time:	16.44897008	, Strain:	-0.208304912	},
    {Time:	16.44920993	, Strain:	-0.185503024	},
    {Time:	16.44946003	, Strain:	-0.161506644	},
    {Time:	16.44970012	, Strain:	-0.145540215	},
    {Time:	16.44994998	, Strain:	-0.142363119	},
    {Time:	16.45019007	, Strain:	-0.151181968	}    
  ];

  // create table
  const container = document.getElementById("table-div");
  const hot = new Handsontable(
    container,
    Object.assign({}, tableCommonOptions, {
      data: tableData,
      colHeaders: ["Time", "Strain"], // need to change to filter1, filter2
      columns: [
        {
          data: "Time",
          type: "numeric",
          numericFormat: { pattern: { mantissa: 2 } },
        },
        {
          data: "Strain",
          type: "numeric",
          numericFormat: { pattern: { mantissa: 2 } },
        },
      ]
    })
  );
  // create chart
  const ctx = (
    document.getElementById("myChart") as HTMLCanvasElement
  ).getContext("2d");
  const myChart = new Chart(ctx, {
    type: "line",
    data: {
      datasets: [
        {
          label: "Model",
          data: null, // will be generated later
          borderColor: colors["blue"],
          backgroundColor: colors["white-0"],
          borderWidth: 2,
          tension: 0.1,
          pointRadius: 0,
          fill: false,
          immutableLabel: true,
        },
        {
          label: "Data",
          data: [],
          backgroundColor: colors["red"],
          fill: false,
          showLine: true,
          pointRadius: 5,
          pointHoverRadius: 7,
          immutableLabel: false,
        },
      ],
    },
    options: {
      hover: {
        mode: "nearest",
      },
      scales: {
        x: {
          //label: 'B-V',
          type: "linear",
          position: "bottom",
        },
        y: {
          //label: 'V',
          reverse: false,
          suggestedMin: 0,
        },
      },
    },
  });
  console.log(myChart);
  const update = function () {
    //console.log(tableData);
    updateTableHeight(hot);
    updateWave(hot, myChart, gravityForm, 1);  
    
  };

  // link chart to table
  hot.updateSettings({
    afterChange: update,
    afterRemoveRow: update,
    afterCreateRow: update,
  });

  const fps = 100;
  const frameTime = Math.floor(1000 / fps);
  gravityForm.oninput = throttle(
    function () {updateWave(hot,myChart,gravityForm,1)},
    frameTime);
  // link chart to model form (slider + text)

  filterForm.oninput = function () {
    //console.log(tableData);
//leaving this stuff here just in case we need drop down dependencies later
    const reveal: string[] = [
    ];

    const columns: string[] = hot.getColHeader() as string[];
    const hidden: number[] = [];
    for (const col in columns) { //cut off " Mag"
      if (!reveal.includes(columns[col])) {
        //if the column isn't selected in the drop down, hide it
        hidden.push(parseFloat(col));
      }
    }

    hot.updateSettings({
      hiddenColumns: {
        columns: hidden,
        // copyPasteEnabled: false,
        indicators: false,
      },
    });

    update();
    updateLabels(
      myChart,
      document.getElementById("chart-info-form") as ChartInfoForm
    );
    myChart.update("none");
  };
  update();

  myChart.options.plugins.title.text = "Title";
  myChart.options.scales["x"].title.text = "x";
  myChart.options.scales["y"].title.text = "y";
  updateLabels(
    myChart,
    document.getElementById("chart-info-form") as ChartInfoForm,
    false,
    false,
    false,
    false
  );

  return [hot, myChart];
}

/**
 * This function handles the uploaded file to the variable chart. Specifically, it parse the file
 * and load related information into the table.
 * DATA FLOW: file -> table
 * @param {Event} evt The uploadig event
 * @param {Handsontable} table The table to be updated
 * @param {Chartjs} myChart
 */

//remember later to change the file type to .hdf5
export function gravityFileUpload(
  evt: Event,
  table: Handsontable,
  myChart: Chart<"line">
) 
{
  // console.log("gravityFileUpload called");
  const file = (evt.target as HTMLInputElement).files[0];

  if (file === undefined) {
    return;
  }

  // File type validation
  if (
    !file.type.match("(text/csv|application/vnd.ms-excel)") &&
    !file.name.match(".*.csv")
  ) {
    console.log("Uploaded file type is: ", file.type);
    console.log("Uploaded file name is: ", file.name);
    alert("Please upload a CSV file.");
    return;
  }

  const reader = new FileReader();
  reader.onload = () => {
    const gravityForm = document.getElementById("gravity-form") as GravityForm;
    // console.log(gravityForm.elements['d'].value);
    gravityForm["dist"].value = Math.log(300).toString();
    // console.log(gravityForm.elements['d'].value);
    gravityForm["mass"].value = Math.log(25).toString();
    gravityForm["ratio"].value = "1";
    gravityForm["merge"].value = "50";
    gravityForm["dist_num"].value = "300";
    gravityForm["mass_num"].value = "25";
    gravityForm["ratio_num"].value = "1";
    gravityForm["merge_num"].value = "50";
    myChart.options.plugins.title.text = "Title";
    myChart.data.datasets[1].label = "Data";
    myChart.options.scales["x"].title.text = "x";
    myChart.options.scales["y"].title.text = "y";
    updateLabels(
      myChart,
      document.getElementById("chart-info-form") as ChartInfoForm,
      false,
      false,
      false,
      false
    );
  }}
function updateWave(
  table: Handsontable,
  myChart: Chart,
  gravityForm: GravityForm,
  dataSetIndex: 1) 
  {
      let inc = parseFloat(gravityForm["inc_num"].value);
      let dist = parseFloat(gravityForm["dist_num"].value);
      let merge = parseFloat(gravityForm["merge_num"].value);
    
      let start = 0;
      let chart = myChart.data.datasets[dataSetIndex].data;
      let tableData = table.getData();
      let columns = table.getColHeader();
    
      //Identify the column the selected filter refers to
      let Time = columns.indexOf(gravityForm["Time"].value);
      let Strain = columns.indexOf(gravityForm["Strain"].value);
    
    
      let scaleLimits: { [key: string]: number } = {
        minX: null,
        minY: null,
        maxX: null,
        maxY: null,
      };
    
      for (let i = 0; i < tableData.length; i++) {
        if (
          tableData[i][Time] === null ||
          tableData[i][Strain] === null
         ) {
          continue;
        }
        //red-blue,lum
    
        let x = (tableData[i][Time] + merge);
        let y = (tableData[i][Strain] *(1-(0.5*Math.sin(inc)*100/dist)));
        chart[start++] = {
          x: x,
          y: y,
        };

        if (isNaN(scaleLimits["minX"])) {
          scaleLimits["minX"] = x;
          scaleLimits["maxX"] = x;
          scaleLimits["minY"] = y;
          scaleLimits["maxY"] = y;
        } else {
         if (y > scaleLimits["maxY"]) {
            scaleLimits["maxY"] = y;
         } else if (y < scaleLimits["minY"]) {
           scaleLimits["minY"] = y;
    }
          if (x > scaleLimits["maxX"]) {
           scaleLimits["maxX"] = x;
          } else if (x < scaleLimits["minX"]) {
            scaleLimits["minX"] = x;
          }
        }
  
  while (chart.length !== start) {
    chart.pop();
  }

  //   scale chart y-axis based on minimum and maximum y value
  let xBuffer = (scaleLimits["maxX"] - scaleLimits["minX"]) * 0.2;
  let yBuffer = (scaleLimits["maxY"] - scaleLimits["minY"]) * 0.2;
  let minbuffer = 0.1;
  let maxbuffer = 1;
  xBuffer = (xBuffer > minbuffer ? (xBuffer < maxbuffer ? xBuffer : maxbuffer)  : minbuffer)
  yBuffer = (yBuffer > minbuffer ? (yBuffer < maxbuffer ? yBuffer : maxbuffer) : minbuffer)
  myChart.options.scales["y"] = {
    min: isNaN(scaleLimits["minY"])
      ? 0
      : scaleLimits["minY"] - yBuffer,
    max: isNaN(scaleLimits["maxY"])
      ? 0
      : scaleLimits["maxY"] + yBuffer,
    reverse: false,
    suggestedMin: 0,
  };
  myChart.options.scales["x"] = {
    min: isNaN(scaleLimits["minX"])
      ? 0
      : scaleLimits["minX"] - xBuffer,
    max: isNaN(scaleLimits["maxX"])
      ? 0
      : scaleLimits["maxX"] + xBuffer,
    type: "linear",
    position: "bottom",
  };
  myChart.update()
}

  }
   
/**
 *  This function takes a form to obtain the 4 parameters (a, p, phase, tilt) that determines the
 *  relationship between a moon's angular distance and Julian date, and generates a dataset that
 *  spans over the range determined by the max and min value present in the table.
 *  @param table:   A table used to determine the max and min value for the range
 *  @param form:    A form containing the 4 parameters (amplitude, period, phase, tilt)
 *  @param chart:   The Chartjs object to be updated.
 */
//insert graviational wave function here

/**
 *  This function generates the data used for functions "updateHRModel" and "gravityGenerator."
 *
 *  @param d:            Distance to the Gravity
 *  @param r:            % of the range
 *  @param age:          Age of the Gravity
 *  @param reddening:    The reddening of the observation
 *  @param metallicity:  Metallicity of the gravity
 *  @param start:        The starting point of the data points
 *  @param end:          The end point of the data points
 *  @param steps:        Steps generated to be returned in the array. Default is 500
 *  @returns {Array}
 */

 


    //finding the maximum and minimum of y value for chart scaling
    
  

